## Отчет по Лабораторной работе №4 <br> "Эмуляция распределенной корпоративной сети связи, настройка iBGP, организация L3VPN, VPLS"

### Информация об отчёте

**_Учебное заведение_**: Университет ИТМО  
**_Факультет_**: Инфокоммуникационные технологии  
**_Образовательная программа_**: Инфокоммуникационные технологии и системы связи  
**_Учебная группа_**: K33212  
**_Отчёт подготовил_**: Тельнов Федор Николаевич  
**_Дата_**: 22.02.2023

### Описание работы

Компания "RogaIKopita Games" выпустила игру "Allmoney Impact", нагрузка на арендные сервера возрасли и вам поставлена задача стать LIR и организовать свою AS чтобы перенести все сервера игры на свою инфраструктуру. После организации вашей AS коллеги из отдела DEVOPS попросили вас сделать L3VPN между 3 офисами для служебных нужд. (Рисунок 1) Данный L3VPN проработал пару недель и коллеги из отдела DEVOPS попросили вас сделать VPLS для служебных нужд.

### Цель работы

Изучить протоколы BGP, MPLS и правила организации L3VPN и VPLS.

### Ход работы

#### 1. Схема связи

Была собрана схема, находящаяся в [конфигурационном файле](schema.clab.yml). Она была задеплоена с помощью `containerlab`. Результат деплоя и схема показаны на рисунках ниже.

![schema deploy](img/schema_deploy.png)

![schema graph](img/schema_graph.png)

#### 2. VRF: Настройка устройств

Для начала инициализируется связь между устройствами. Также на всех устройствах создается мост Loopback с уникальными ip. На примере роутеров HKI и SPB показана конфигурация:

- SPB

![hki](img/2_hki)

![spb](img/2_spb)

#### 3. Инициализация VRF

На всех устройствах, связанных с ПК, был создан VRF.

- NY

![ny](img/3_ny)

- SVL

![svl](img/3_svl)

- SPB

![spb](img/3_spb)

Для каждого из этих роутеров создалась новая таблица маршрутизации.

#### 4. OSPF

На примере роутера NY настраивается OSPF.

![ospf_1](img/4_ospf_1)

![ospf_2](img/4_ospf_2)

![ospf_3](img/4_ospf_3)

Видно, что OSPF протокол не затрагивает ранее сконфигурированный VRF.

#### 5. BGP

Аналогично на примере роутера NY настраивается iBGP

![bgp_1](img/bgp_1)

![bgp_2](img/bgp_2)

![bgp_3](img/bgp_3)

Router reflect настраивается на роутерах LND и HKI

После аналогичной настройки на лондонском роутере наблюдается установленное соединение.

![bgp_4](img/bgp_4)

Точно также настраиваются остальные связи между роутерами. Для каждого роутера появятся соответствующие настройки.

#### 6. HKI

![hki_1](img/hki_1)

После настраивается vrf на bgp для устройств, соединенных с пк.

![hki_2](img/hki_2)

#### 7. MPLS

Для каждого роутера настраивается MPLS. Пример для роутера NY ниже.

- NY

![mpls_1](img/mpls_1)

![mpls_2](img/mpls_2)

После настройки всех роутеров и их интерфейсов:

![mpls_3](img/mpls_3)

После настройки router reflect (BGP) обновится таблица VRF

- NY

![mpls_4](img/mpls_4)

- SVL

![mpls_5](img/mpls_5)

- SPB

![mpls_6](img/mpls_6)

8. VPLS. Настройка мостов

Разбирается таблица VRF и настраивается VPLS.

![vpls_1](img/vpls_1)

Для соответственного удаленного устройства создается интерфейс vpls

- NY

Создается мост VPLS

![vpls_2](img/vpls_2)

И два интерфейса для удаленных устройств.

![vpls_3](img/vpls_3)

Далее связываются на других устройствах

![vpls_4](img/vpls_4)

#### 8. Проверка

- PC2 - PC3; PC2 - PC1

![check_2](img/check_2)

- Для NY

![check_3](img/check_3)

- PC1 - PC2; PC1 - PC3

![check_4](img/check_4)

**7. Выводы**

В ходе выполнения данной лабораторной работы на практике изучены эмуляция распределенной корпоративной сети связи, настройка iBGP, организация L3VPN, VPLS
